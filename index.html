<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modernize HR with Smart Automation - Hire To Retire</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Enhanced styling for better UX */
        .form-submitting {
            opacity: 0.7;
            pointer-events: none;
        }

        .success-message {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-top: 1rem;
            text-align: center;
            animation: slideInFromTop 0.5s ease-out;
            box-shadow: 0 10px 25px rgba(16, 185, 129, 0.3);
        }

        .error-message {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
            padding: 1.5rem;
            border-radius: 0.75rem;
            margin-top: 1rem;
            text-align: center;
            animation: slideInFromTop 0.5s ease-out;
            box-shadow: 0 10px 25px rgba(239, 68, 68, 0.3);
        }

        @keyframes slideInFromTop {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .field-error {
            font-size: 0.875rem;
            color: #ef4444;
            margin-top: 0.5rem;
            font-weight: 500;
        }

        .border-red-500 {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }

        .spinner {
            display: inline-block;
            width: 18px;
            height: 18px;
            border: 2px solid #ffffff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Enhanced focus states */
        input:focus, textarea:focus, select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
            outline: none;
            transform: translateY(-1px);
            transition: all 0.2s ease;
        }

        /* Hover effects for better interactivity */
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.3);
        }

        .form-container {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-yellow-100 via-orange-100 to-yellow-200 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header Section -->
        <div class="text-center mb-12">
            <div class="mb-6">
                <div class="mx-auto h-16 w-auto bg-gray-800 text-white rounded-lg px-6 py-4 inline-block font-bold text-xl">
                    TalentTrack
                </div>
            </div>
            <h1 class="text-4xl md:text-6xl font-bold text-gray-800 mb-4 leading-tight">
                Modernize HR with Smart Automation
            </h1>
            <p class="text-2xl text-gray-700 mb-4 font-semibold">Hire To Retire</p>
            <p class="text-lg text-gray-600 mb-8 max-w-3xl mx-auto">
                Automate every stage—from hiring to retirement<br>
                <span class="font-semibold">"100% Configurable workflows that grow with you"</span>
            </p>
            <p class="text-sm text-gray-600 bg-white/50 rounded-full px-6 py-2 inline-block">
                ✅ Backed by 2,000+ top Indian enterprises
            </p>
        </div>

        <!-- Form Section -->
        <div class="max-w-lg mx-auto form-container rounded-2xl shadow-2xl p-8">
            <div class="text-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800 mb-2">Get Started Today</h2>
                <p class="text-gray-600">Transform your HR processes in minutes</p>
            </div>

            <form id="leadForm" class="space-y-5">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <input type="text" id="firstName" name="firstName" placeholder="First Name*" 
                               class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200" required>
                    </div>
                    <div>
                        <input type="text" id="lastName" name="lastName" placeholder="Last Name*" 
                               class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200" required>
                    </div>
                </div>
                
                <div>
                    <input type="email" id="email" name="email" placeholder="Business Email*" 
                           class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200" required>
                </div>
                
                <div>
                    <!-- Phone is now a required field based on the new API spec -->
                    <input type="tel" id="phone" name="phone" placeholder="Phone Number*" 
                           class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200" required>
                </div>
                
                <div>
                    <input type="text" id="companyName" name="companyName" placeholder="Company Name" 
                           class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200">
                </div>

                <!-- New field: Company Size -->
                <div>
                    <select id="companySize" name="companySize" 
                            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200 bg-white">
                        <option value="">Select Company Size</option>
                        <option value="1-10">1-10 employees</option>
                        <option value="11-50">11-50 employees</option>
                        <option value="51-200">51-200 employees</option>
                        <option value="201-500">201-500 employees</option>
                        <option value="501-1000">501-1000 employees</option>
                        <option value="1001-5000">1001-5000 employees</option>
                        <option value="5000+">5000+ employees</option>
                    </select>
                </div>
                
                <div>
                    <input type="text" id="title" name="title" placeholder="Job Title" 
                           class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200">
                </div>
                
                <div>
                    <select id="designation" name="designation" 
                            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200 bg-white">
                        <option value="">Select Your Role</option>
                        <option value="HR Manager">HR Manager</option>
                        <option value="HR Director">HR Director</option>
                        <option value="CHRO">Chief Human Resources Officer (CHRO)</option>
                        <option value="VP HR">VP of Human Resources</option>
                        <option value="HR Business Partner">HR Business Partner</option>
                        <option value="Talent Acquisition Manager">Talent Acquisition Manager</option>
                        <option value="CEO">Chief Executive Officer (CEO)</option>
                        <option value="COO">Chief Operating Officer (COO)</option>
                        <option value="Founder">Founder</option>
                        <option value="Operations Manager">Operations Manager</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div>
                    <textarea id="notes" name="notes" placeholder="Tell us about your HR challenges and automation needs..." rows="4"
                              class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200 resize-none"></textarea>
                </div>
                
                <div>
                    <!-- Value is now a string type based on the new API spec -->
                    <input type="text" id="value" name="value" placeholder="Expected Budget (USD)" 
                           class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200">
                </div>
                
                <div>
                    <input type="url" id="linkedin" name="linkedin" placeholder="LinkedIn Profile (Optional)" 
                           class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200">
                </div>
                
                <div>
                    <input type="url" id="website" name="website" placeholder="Company Website (Optional)" 
                           class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-blue-500 transition-all duration-200">
                </div>
                
                <button type="submit" id="submitButton"
                        class="w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-4 px-6 rounded-lg font-bold text-lg hover:from-green-600 hover:to-green-700 transition-all duration-300 transform hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none">
                    <span id="buttonText">🚀 GET FREE CONSULTATION</span>
                </button>
                
                <p class="text-xs text-gray-500 text-center mt-4 leading-relaxed">
                    By submitting this form, you agree to receive communications about our HR automation solutions. 
                    <br>We respect your privacy and will never share your information.
                </p>
            </form>
        </div>

        <!-- Trust indicators -->
        <div class="text-center mt-12">
            <p class="text-sm text-gray-600 mb-4">Trusted by industry leaders</p>
            <div class="flex justify-center items-center space-x-8 opacity-60">
                <span class="font-semibold">Enterprise Ready</span>
                <span>•</span>
                <span class="font-semibold">GDPR Compliant</span>
                <span>•</span>
                <span class="font-semibold">24/7 Support</span>
            </div>
        </div>
    </div>

    <script>
        // LeadSpare API Configuration
        const LEADSPARE_CONFIG = {
            endpoint: 'https://leadspare-backend.vercel.app/api/v1/webhooks/lead',
            apiKey: 'a1ea77f056ad94fdb55e9e2f21d2df00da5918e98250d22b600c2af3bc073010',
            timeout: 15000,
            maxRetries: 3 // This is not used in the current simplified logic, but kept for reference
        };

        class LeadFormHandler {
            constructor() {
                this.form = document.getElementById('leadForm');
                this.submitButton = document.getElementById('submitButton');
                this.buttonText = document.getElementById('buttonText');
                this.isSubmitting = false;
                this.init();
            }

            init() {
                this.setupValidation();
                this.setupFormSubmission();
                this.trackPageLoad();
            }

            setupValidation() {
                const inputs = this.form.querySelectorAll('input, textarea, select');
                
                inputs.forEach(input => {
                    input.addEventListener('blur', (e) => this.validateField(e.target));
                    input.addEventListener('input', (e) => this.clearErrors(e.target));
                    input.addEventListener('focus', (e) => this.trackFieldFocus(e.target.name));
                });
            }

            validateField(field) {
                const value = field.value.trim();
                const fieldName = field.name;
                let isValid = true;
                let errorMessage = '';

                // Clear previous errors
                this.clearErrors(field);

                // Check required fields
                if (field.hasAttribute('required') && !value) {
                    isValid = false;
                    errorMessage = 'This field is required';
                } else if (value) {
                    // Field-specific validation
                    switch(fieldName) {
                        case 'email':
                            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                            if (!emailPattern.test(value)) {
                                isValid = false;
                                errorMessage = 'Please enter a valid email address';
                            }
                            break;
                        case 'phone':
                            // Phone is now required, so check for value first
                            // Relaxed phone pattern to allow more formats, but still basic validation
                            const phonePattern = /^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/;
                            if (!phonePattern.test(value)) {
                                isValid = false;
                                errorMessage = 'Please enter a valid phone number';
                            }
                            break;
                        case 'linkedin':
                            const linkedinPattern = /^https:\/\/(www\.)?linkedin\.com\/in\/[a-zA-Z0-9\-_]+\/?$/;
                            if (!linkedinPattern.test(value)) {
                                isValid = false;
                                errorMessage = 'Please enter a valid LinkedIn profile URL (e.g., https://linkedin.com/in/username)';
                            }
                            break;
                        case 'website':
                            const urlPattern = /^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)$/;
                            if (!urlPattern.test(value)) {
                                isValid = false;
                                errorMessage = 'Please enter a valid website URL (e.g., https://example.com)';
                            }
                            break;
                        case 'firstName':
                        case 'lastName':
                            if (value.length < 2 || !/^[a-zA-Z\s]+$/.test(value)) {
                                isValid = false;
                                errorMessage = 'Name must contain only letters and be at least 2 characters';
                            }
                            break;
                        case 'value':
                            // Value is now a string, but still represents a number, so keep numeric validation
                            if (isNaN(value) || parseFloat(value) < 0) {
                                isValid = false;
                                errorMessage = 'Please enter a valid positive number';
                            }
                            break;
                    }
                }

                if (!isValid) {
                    this.showFieldError(field, errorMessage);
                }

                return isValid;
            }

            showFieldError(field, message) {
                field.classList.add('border-red-500');
                
                const errorDiv = document.createElement('div');
                errorDiv.className = 'field-error';
                errorDiv.textContent = message;
                // Insert error message after the input field
                field.parentNode.insertBefore(errorDiv, field.nextSibling);
            }

            clearErrors(field) {
                field.classList.remove('border-red-500');
                const errorMsg = field.parentNode.querySelector('.field-error');
                if (errorMsg) errorMsg.remove();
            }

            setupFormSubmission() {
                this.form.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    
                    if (this.isSubmitting) return;
                    
                    if (this.validateForm()) {
                        await this.submitLead();
                    }
                });
            }

            validateForm() {
                const inputs = this.form.querySelectorAll('input, textarea, select');
                let isFormValid = true;

                // Validate all fields and collect overall form validity
                inputs.forEach(input => {
                    if (!this.validateField(input)) {
                        isFormValid = false;
                    }
                });

                // Scroll to the first invalid field if form is not valid
                if (!isFormValid) {
                    const firstInvalidField = this.form.querySelector('.border-red-500');
                    if (firstInvalidField) {
                        firstInvalidField.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }

                return isFormValid;
            }

            async submitLead() {
                this.setLoadingState(true);
                
                try {
                    const leadData = this.prepareLeadData();
                    console.log('Attempting to submit lead data:', leadData);

                    const response = await fetch(LEADSPARE_CONFIG.endpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'x-api-key': LEADSPARE_CONFIG.apiKey,
                            'Accept': 'application/json'
                        },
                        body: JSON.stringify(leadData),
                        signal: AbortSignal.timeout(LEADSPARE_CONFIG.timeout)
                    });

                    if (!response.ok) {
                        let errorDetail = response.statusText;
                        try {
                            const errorJson = await response.json();
                            if (errorJson.message) {
                                errorDetail = errorJson.message;
                            } else if (errorJson.error) {
                                errorDetail = errorJson.error;
                            }
                        } catch (jsonError) {
                            // Ignore JSON parsing error, use statusText
                        }
                        throw new Error(`HTTP Error ${response.status}: ${errorDetail}`);
                    }

                    const result = await response.json();
                    this.handleSuccess({ success: true, data: result, method: 'direct' });

                } catch (error) {
                    console.error('Lead submission error:', error);
                    this.handleError(error);
                } finally {
                    this.setLoadingState(false);
                }
            }

            prepareLeadData() {
                const formData = new FormData(this.form);
                
                const leadData = {
                    firstName: formData.get('firstName'),
                    lastName: formData.get('lastName'),
                    email: formData.get('email'),
                    // Phone is now required
                    phone: formData.get('phone'), 
                    companyName: formData.get('companyName') || undefined,
                    // New field: companySize
                    companySize: formData.get('companySize') || undefined,
                    title: formData.get('title') || undefined,
                    designation: formData.get('designation') || undefined,
                    notes: formData.get('notes') || undefined,
                    source: "HR Automation Website - TalentTrack", // Hardcoded source
                    // Value is now a string, no parseFloat needed
                    value: formData.get('value') || undefined, 
                    linkedin: formData.get('linkedin') || undefined,
                    website: formData.get('website') || undefined
                };

                // Remove undefined or empty string values (except for required fields which are handled by validation)
                Object.keys(leadData).forEach(key => {
                    if (leadData[key] === undefined || leadData[key] === '') {
                        // Keep required fields even if empty, as validation handles them
                        if (key !== 'firstName' && key !== 'lastName' && key !== 'email' && key !== 'phone') {
                            delete leadData[key];
                        }
                    }
                });

                return leadData;
            }
            
            handleSuccess(result) {
                console.log('Submission successful:', result);
                
                this.form.reset(); // Clear the form fields
                this.trackEvent('lead_submitted_successfully', {
                    method: result.method,
                    timestamp: new Date().toISOString()
                });

                let successMessage = `🎉 Thank you! Your information has been submitted successfully.<br><br>
                                      <strong>What happens next?</strong><br>
                                      • Our HR automation expert will contact you within 2 hours<br>
                                      • We'll schedule a personalized demo based on your needs<br>
                                      • Get a custom implementation roadmap for your company<br><br>
                                      <em>Check your email for confirmation details.</em>`;

                this.showMessage(successMessage, 'success');
            }

            handleError(error) {
                let errorMessage = 'We encountered an issue submitting your information.';
                
                if (error.message.includes('timeout')) {
                    errorMessage = 'The request timed out. Please check your connection and try again.';
                } else if (error.message.includes('401')) {
                    errorMessage = 'Authentication error. Please ensure your API key is correct or contact support.';
                } else if (error.message.includes('400')) {
                    errorMessage = 'Please check your information and try again. Some fields might be invalid.';
                } else if (error.message.includes('500')) {
                    errorMessage = 'Server error. Our technical team has been notified. Please try again later.';
                } else if (error.message.includes('Failed to fetch')) {
                    errorMessage = 'Network error or server unreachable. Please check your internet connection.';
                }

                this.trackEvent('lead_submission_error', {
                    error: error.message,
                    timestamp: new Date().toISOString()
                });

                this.showMessage(
                    `❌ ${errorMessage}<br><br>
                    <strong>Alternative ways to reach us:</strong><br>
                    • Email: contact@talenttrack.com<br>
                    • Phone: +1 (555) 123-4567<br>
                    • WhatsApp: +1 (555) 987-6543<br><br>
                    <em>We'll respond within 1 hour during business hours.</em>`, 
                    'error'
                );
            }

            setLoadingState(isLoading) {
                this.isSubmitting = isLoading;
                
                if (isLoading) {
                    this.form.classList.add('form-submitting');
                    this.submitButton.disabled = true;
                    this.buttonText.innerHTML = '<div class="spinner"></div>Submitting Your Request...';
                } else {
                    this.form.classList.remove('form-submitting');
                    this.submitButton.disabled = false;
                    this.buttonText.textContent = '🚀 GET FREE CONSULTATION';
                }
            }

            showMessage(message, type) {
                // Remove existing messages
                const existing = this.form.querySelector('.success-message, .error-message');
                if (existing) existing.remove();

                const messageDiv = document.createElement('div');
                messageDiv.className = type === 'success' ? 'success-message' : 'error-message';
                messageDiv.innerHTML = message;
                
                this.form.appendChild(messageDiv);
                
                // Scroll to message
                messageDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Auto-remove after delay
                const delay = type === 'success' ? 12000 : 15000;
                setTimeout(() => {
                    if (messageDiv.parentNode) messageDiv.remove();
                }, delay);
            }

            trackEvent(eventName, properties = {}) {
                console.log(`📊 Event: ${eventName}`, properties);
                
                // Google Analytics integration
                // Ensure gtag is defined before calling it
                if (typeof gtag === 'function') {
                    gtag('event', eventName, properties);
                } else {
                    console.warn('gtag is not defined. Google Analytics tracking may not be active.');
                }
                
                // You can add other analytics services here
            }

            trackFieldFocus(fieldName) {
                this.trackEvent('form_field_focused', { field: fieldName });
            }

            trackPageLoad() {
                this.trackEvent('form_page_loaded', {
                    url: window.location.href,
                    timestamp: new Date().toISOString(),
                    userAgent: navigator.userAgent
                });
            }
        }

        // Initialize the form handler when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            new LeadFormHandler();
        });

        // Global error handling for unhandled promise rejections
        window.addEventListener('unhandledrejection', (event) => {
            console.error('Unhandled promise rejection:', event.reason);
            // Optionally, display a generic error message to the user
            const handler = new LeadFormHandler(); // Re-initialize to use showMessage
            handler.showMessage('An unexpected error occurred. Please try again or contact support.', 'error');
        });
    </script>
</body>
</html>
